<!-- <!DOCTYPE html> -->
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</title>
  <link rel="stylesheet" href="./css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js"></script>


</head>

<body>
  <div class="container">
    <h1>–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–≥–æ –æ—Ç–¥–µ–ª–∞ –ë—Ä–ì–¢–£</h1>
    <div class="menu-container">

      <div class="actions">
        <h2>–ó–∞–≥—Ä—É–∑–∏—Ç—å/–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</h2>


        <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ Excel -->
        <button id="upload-xlsx">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª Excel</button>

        <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ JSON -->
        <button id="download-json">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ JSON</button>

        <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ JSON -->
        <button id="load-json">–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ JSON</button>

        <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ XLSX -->

        <button id="download-xlsx-file">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ XLSX</button>

        <!-- –°–∫—Ä—ã—Ç—ã–π input –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞ -->
        <input type="file" id="upload" accept=".xls,.xlsx" style="display: none;">
      </div>

    </div>

    <div class="settings-icon">
      <i class="far fa-user-circle"> –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞</i>
      <div class="search-container">
        <i class="fa fa-search"></i>
        <label for="student-search">–ü–æ–∏—Å–∫ —Å—Ç—É–¥–µ–Ω—Ç–∞</label>
        <div class="search-input-wrapper">
          <input type="text" id="student-search" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ñ–∞–º–∏–ª–∏—é">
        </div>
      </div>
      <i class="fa fa-cogs">
        <span class="icon-text"> –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</span>
      </i>
      <!-- –®–µ—Å—Ç–µ—Ä—ë–Ω–∫–∞ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é -->
    </div>



    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
    <div id="modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <button id="print-button" class="print-icon">üñ®Ô∏è</button>
          <button id="edit-button" class="edit-icon">‚úé</button>
          <button id="delete-button" class="delete-icon">üóëÔ∏è</button>

          <button id="close-button" class="close-icon">&times;</button>
          <button id="save-button" class="save-icon">üíæ</button>
        </div>
        <h2>–î–∞–Ω–Ω—ã–µ —Å—Ç—É–¥–µ–Ω—Ç–∞</h2>
        <div id="modal-details" class="modal-details-table"></div>
      </div>
    </div>

    <table id="student-table">
      <thead>
        <thead>
          <tr>
            <th rowspan="2" style="width: 40px; text-align: center;">‚Ññ</th>
            <th rowspan="2" style="width: 160px; text-align: left;">–§–ò–û</th>
            <th rowspan="2" style="width: 160px; text-align: left;">–§–ò–û (–∞–Ω–≥–ª)</th>
            <th rowspan="2" style="width: 60px; text-align: center;">–ü—Ä–∏–∫–∞–∑</th>
            <th rowspan="2" style="width: 80px; text-align: center;">–î–∞—Ç–∞ –ø—Ä–∏–∫–∞–∑–∞</th>
            <th rowspan="2" style="width: 80px; text-align: center;">–ì–æ–¥ —Ä–æ–∂–¥–µ–Ω–∏—è</th>
            <th rowspan="2" style="width: 150px; text-align: left;" id="country">–°—Ç—Ä–∞–Ω–∞</th>
            <th rowspan="2" style="width: 50px; text-align: center;" id="gender">–ü–æ–ª</th>
            <th rowspan="2" style="width: 150px; text-align: left;">–°–µ—Ä–∏—è –∏ –Ω–æ–º–µ—Ä –ø–∞—Å–ø–æ—Ä—Ç–∞, –¥–∞—Ç–∞ –≤—ã–¥–∞—á–∏, —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è
            </th>
            <th rowspan="2" style="width: 100px; text-align: center ;" id="group">–ì—Ä—É–ø–ø–∞</th>
            <th rowspan="2" style="width: 100px; text-align: left;" id="faculty">–§–∞–∫—É–ª—å—Ç–µ—Ç</th>
            <th rowspan="2" style="width: 60px; text-align: center;" id="course">–ö—É—Ä—Å</th>
            <th rowspan="2" style="width: 120px; text-align: left;" id="note">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ*</th>
            <th rowspan="2" style="width: 70px; text-align: center;" id="educationType">–§–æ—Ä–º–∞ –æ–±—É—á–µ–Ω–∏—è</th>
            <th rowspan="2" style="width: 120px; text-align: left;">–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø—Ä–µ–±—ã–≤–∞–Ω–∏–µ</th>

            <!-- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –Ω–∞ "—Å" –∏ "–ø–æ" -->
            <th colspan="3" class="permission-header" style="text-align: center; width: 220px;">–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ
              –ø—Ä–µ–±—ã–≤–∞–Ω–∏–µ —Å</th>
            <th colspan="3" class="permission-header" style="text-align: center; width: 220px;">–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ
              –ø—Ä–µ–±—ã–≤–∞–Ω–∏–µ –ø–æ</th>

            <th rowspan="2" style="width: 200px; text-align: left;">–î–æ–º–∞—à–Ω–∏–π –∞–¥—Ä–µ—Å</th>
            <th rowspan="2" style="width: 120px; text-align: left;">–û–±—â–µ–∂–∏—Ç–∏–µ/–∫–≤–∞—Ä—Ç–∏—Ä–∞</th>
            <th rowspan="2" style="width: 100px; text-align: center;" id="admissionYear">–ì–æ–¥ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è</th>
            <th rowspan="2" style="width: 100px; text-align: center;" id="graduationYear">–ì–æ–¥ –æ–∫–æ–Ω—á–∞–Ω–∏—è</th>
            <th rowspan="2" style="width: 150px; text-align: left;">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**</th>
            <th rowspan="2" style="width: 150px; text-align: left;" id="curator">–ö—É—Ä–∞—Ç–æ—Ä</th>
            <th rowspan="2" style="width: 150px; text-align: left;">–¢–µ–ª–µ—Ñ–æ–Ω –∫—É—Ä–∞—Ç–æ—Ä–∞</th>
            <th rowspan="2" style="width: 150px; text-align: left;">–¢–µ–ª–µ—Ñ–æ–Ω —Å—Ç—É–¥–µ–Ω—Ç–∞</th>
            <th rowspan="2" style="width: 150px; text-align: left;">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ***</th>
          </tr>
          <tr>
            <!-- –ü—Ä–∏–≤—è–∑–∫–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è "–î–µ–Ω—å", "–ú–µ—Å—è—Ü", "–ì–æ–¥" –∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—é –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø—Ä–µ–±—ã–≤–∞–Ω–∏–µ -->
            <th style="width: 30px; text-align: center;">–î–µ–Ω—å</th>
            <th style="width: 70px; text-align: center;">–ú–µ—Å—è—Ü</th>
            <th style="width: 40px; text-align: center;">–ì–æ–¥</th>
            <th style="width: 40px; text-align: center;">–î–µ–Ω—å_</th>
            <th style="width: 70px; text-align: center;">–ú–µ—Å—è—Ü_</th>
            <th style="width: 40px; text-align: center;">–ì–æ–¥_</th>
          </tr>
        </thead>

      <tbody>
        <!-- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
      </tbody>
    </table>
  </div>

  <div id="notification" style="display: none;">
    –§–∞–π–ª JSON –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–æ–≤—ã–π —Ñ–∞–π–ª.
  </div>

  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>



  <!-- <script type="module" src="js/main.js"></script> -->
  <script type="module" src="./js/main.js"></script>
  <script type="module" src="./js/indexedDB.js"></script>
  <script type="module" src="./js/utils.js"></script>
  <script type="module" src="./js/selectedDB.js"></script>

  <!-- <script type="module" src="/js/app.js"></script> -->
  <!-- <script type="module" src="/js/app.js"></script> -->

  <!-- <script type="module" src="/js/selected.js"></script> -->


  <!-- <script type="module" src="/js/modal.js"></script> -->
  <!-- <script type="module" src="/js/scan.js"></script> -->
  <!-- <script type="module" src="/js/indexedDBUtils.js"></script> -->
  <!-- <script type="module" src="/js/modalNew.js"></script> -->


  <!-- –î–æ–±–∞–≤—å—Ç–µ –∫–æ–¥ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å-–≤–æ—Ä–∫–µ—Ä–∞ –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–º —Ç–µ–≥–æ–º </body> -->
  <script>
    // if ('serviceWorker' in navigator) {
    //   window.addEventListener('load', () => {
    //     navigator.serviceWorker.register('./service-worker.js')
    //       .then((registration) => {
    //         console.log('Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω —Å —É—Å–ø–µ—à–Ω—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º:', registration);
    //       })
    //       .catch((error) => {
    //         console.log('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Service Worker:', error);
    //       });
    //   });
    // }
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        // –£–¥–∞–ª–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Service Worker
        navigator.serviceWorker.getRegistrations().then((registrations) => {
          registrations.forEach((registration) => {
            registration.unregister()
              .then((unregistered) => {
                if (unregistered) {
                  console.log('Service Worker —É–¥–∞–ª—ë–Ω');
                } else {
                  console.log('–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å Service Worker');
                }
              })
              .catch((error) => {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ Service Worker:', error);
              });
          });
        });

        // –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–µ–π
        if ('caches' in window) {
          caches.keys().then((cacheNames) => {
            cacheNames.forEach((cacheName) => {
              caches.delete(cacheName).then((deleted) => {
                if (deleted) {
                  console.log('–ö–µ—à —É–¥–∞–ª—ë–Ω:', cacheName);
                }
              }).catch((error) => {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–µ—à–∞:', error);
              });
            });
          });
        }
      });
    }

  </script>
</body>

</html>